"use strict";Object.prototype.merge=function(e){for(var t in e)this[t]=e[t]};var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var V360=function(){function e(){_classCallCheck(this,e);for(var t=document.querySelectorAll("[v360], [V360]"),r=0,n=t.length;r<n;r++)this.init(t[r]);return"teste"}return _createClass(e,[{key:"init",value:function(e){if(e.v360&&e.v360.played)return e.v360.restart();var t={target:e,srcs:void 0,sprite:void 0,frames:0,dragSensitivity:5,canvas:this.appendCanvas(e),imgs:[],currentFrame:0,allowDrag:!0,mousePressing:void 0,mouseStart:0,loadedImages:0};t.merge(JSON.parse(e.getAttribute("v360").replace(/\'/g,'"'))),this.preload(t),this.onresize(t),this.V360DOM(e,t)}}]),e}();window.addEventListener("load",function(){return window.v360=new V360}),V360.prototype.appendCanvas=function(e){var t={};return t.target=document.createElement("canvas"),this.resizeCanvas(e,t.target),t.ctx=t.target.getContext("2d"),e.appendChild(t.target),t},V360.prototype.easingFunctions={linear:function(e){return e},easeInQuad:function(e){return e*e},easeOutQuad:function(e){return e*(2-e)},easeInOutQuad:function(e){return e<.5?2*e*e:(4-2*e)*e-1},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return--e*e*e+1},easeInOutCubic:function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return 1- --e*e*e*e},easeInOutQuart:function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e},easeInQuint:function(e){return e*e*e*e*e},easeOutQuint:function(e){return 1+--e*e*e*e*e},easeInOutQuint:function(e){return e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e}},V360.prototype.preload=function(e){for(var t=1;t<=e.frames;t++){var r=e.imgs[e.imgs.push(new Image)-1];if(r.onload=this.onload(e),e.sprite){r.src=e.sprite;break}r.src=e.srcs.replace("#{frame}",("000"+t).slice(-3))}},V360.prototype.resizeCanvas=function(e,t){t.width=e.offsetWidth,t.height=e.offsetHeight},V360.prototype.resizeImage=function(e){for(var t=e.canvas.target,r=e.imgs,n=!!e.sprite,a=e.frames,i=0,o=r.length;i<o;i++){var s=r[i];t.width<=t.height?(n&&(s.width=s.width/a),s.height=s.height*t.width/s.width,s.width=t.width,n&&(s.width=s.width*a)):(n&&(s.width=s.width/a),s.width=s.width*t.height/s.height,s.height=t.height,n&&(s.width=s.width*a))}},V360.prototype.setImage=function(e,t){var r=e.canvas.target,n=e.canvas.ctx,a=e.imgs,i=e.frames,o=!!e.sprite,s=a[o?0:t];if(n.clearRect(0,0,r.width,r.height),o){var u=-s.width/i*t,c=s.width/i;n.drawImage(s,u,0,s.width,s.height),n.clearRect(c,0,r.width-c,r.height)}else n.drawImage(s,0,0,s.width,s.height)},V360.prototype.V360DOM=function(e,t){var r=this,n=t.canvas.target,a=t.frames-1,i=this.onmousedown(t),o=this.onmouseup(t),s=this.onmousemove(t),u=this.onresize(t);n.addEventListener("mousedown",i),window.addEventListener("mouseup",o),window.addEventListener("mousemove",s),window.addEventListener("resize",u),e.v360={played:!0},e.v360.start=function(){r.init(e),e.v360.played=!0},e.v360.stop=function(){n.removeEventListener("mousedown",i),window.removeEventListener("mouseup",o),window.removeEventListener("mousemove",s),window.removeEventListener("resize",u),n&&n.remove(),e.v360.played=!1},e.v360.restart=function(){e.v360.stop(),e.v360.start()};var c=void 0;e.v360.animate=function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"linear",o=arguments[3],s=performance.now(),u=0;t.allowDrag=!1,requestAnimationFrame(function r(m){var h=(m-s)/n,v=this.easingFunctions[i||"linear"](h);if(e==1/0||e==-1/0)~~h>u&&(u=~~h,t.currentFrame+=e==1/0?1:-1);else if(~~(v*Math.abs(e))>u){u=~~(v*Math.abs(e));var d=e/Math.abs(e),f=t.currentFrame+~~(v*e);t.currentFrame+=f/Math.abs(f)*d,console.log(t.currentFrame)}return t.currentFrame>a?t.currentFrame=0:t.currentFrame<0&&(t.currentFrame=a),this.setImage(t,t.currentFrame),c?t.allowDrag=!(c=!1):e==1/0?requestAnimationFrame(r.bind(this)):h<1?requestAnimationFrame(r.bind(this)):"function"==typeof o?o():void(t.allowDrag=!0)}.bind(r))},e.v360.stopAnimation=function(){return c=!0}},V360.prototype.onload=function(e){var t=this;return function(r){e.loadedImages++,e.loadedImages<e.frames&&!e.sprite||(t.resizeImage(e),t.setImage(e,e.currentFrame),t.onmousedown(e),t.onmouseup(e),t.onmousemove(e))}},V360.prototype.onmousedown=function(e){return function(t){e.allowDrag&&(e.mousePressing=!0,e.mouseStart=t.pageX)}},V360.prototype.onmousemove=function(e){var t=this;return function(r){if(r.preventDefault(),e.mousePressing){var n=(e.mouseStart-r.pageX)/e.dragSensitivity;if(n>1&&(n=1),n<-1&&(n=-1),1==n||-1==n){e.mouseStart=r.pageX;var a=Math.round(n);e.currentFrame+=a/Math.abs(a),e.currentFrame>e.frames-1&&(e.currentFrame=0),e.currentFrame<0&&(e.currentFrame=e.frames-1),t.setImage(e,e.currentFrame)}}}},V360.prototype.onmouseup=function(e){return function(){e.mousePressing=!1,e.mouseStart=0}},V360.prototype.onresize=function(e){var t=this;return function(){var r=e.target,n=e.canvas.target;if(n.width!=r.offsetWidth||n.height!=r.height){var a=e.currentFrame;t.resizeCanvas(r,n),t.resizeImage(e),t.setImage(e,a)}}},V360.prototype.restart=function(){for(var e=document.querySelectorAll("[v360], [V360]"),t=0,r=e.length;t<r;t++)e[t].v360.restart()},V360.prototype.set=function(e,t){e.setAttribute("v360",JSON.stringify(t).replace(/\"/g,"'")),this.init(e)},V360.prototype.start=function(){for(var e=document.querySelectorAll("[v360], [V360]"),t=0,r=e.length;t<r;t++)e[t].v360.start()},V360.prototype.stop=function(){for(var e=document.querySelectorAll("[v360], [V360]"),t=0,r=e.length;t<r;t++)e[t].v360.stop()};
//# sourceMappingURL=v360-min.js.map
