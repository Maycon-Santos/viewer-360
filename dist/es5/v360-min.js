"use strict";Object.prototype.merge=function(e){for(var t in e)this[t]=e[t]};var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var V360=function(){function e(){_classCallCheck(this,e);for(var t=document.querySelectorAll("[v360], [V360]"),r=0,n=t.length;r<n;r++)this.init(t[r])}return _createClass(e,[{key:"init",value:function(e){var t={target:e,srcs:void 0,sprite:void 0,frames:0,dragSensitivity:5,canvas:this.appendCanvas(e),imgs:[],currentImg:0,mousePressing:void 0,mouseStart:0,loadedImages:0};t.merge(JSON.parse(e.getAttribute("v360").replace(/\'/g,'"'))),this.preload(t),this.onresize(t),this.V360DOM(e,t)}}]),e}();window.addEventListener("load",function(){return new V360}),V360.prototype.appendCanvas=function(e){var t={};return t.target=document.createElement("canvas"),this.resizeCanvas(e,t.target),t.ctx=t.target.getContext("2d"),e.appendChild(t.target),t},V360.prototype.preload=function(e){for(var t=1;t<=e.frames;t++){var r=e.imgs[e.imgs.push(new Image)-1];if(r.onload=this.onload(e),e.sprite){r.src=e.sprite;break}r.src=e.srcs.replace("#{frame}",("000"+t).slice(-3))}},V360.prototype.resizeCanvas=function(e,t){t.width=e.offsetWidth,t.height=e.offsetHeight},V360.prototype.resizeImage=function(e,t){for(var r=0,n=t.length;r<n;r++){var a=t[r];e.width<=e.height&&n>1?(a.height=a.height*e.width/a.width,a.width=e.width):(a.width=a.width*e.height/a.height,a.height=e.height)}},V360.prototype.setImage=function(e,t,r,n,a){t.clearRect(0,0,e.width,e.height),r.length>1?t.drawImage(r[n],0,0,r[n].width,r[n].height):t.drawImage(r[0],-r[0].width/a*n,0,r[0].width,r[0].height)},V360.prototype.V360DOM=function(e,t){var r=this,n=this.onmousedown(t),a=this.onmouseup(t),o=this.onmousemove(t),i=this.onresize(t);t.canvas.target.addEventListener("mousedown",n),window.addEventListener("mouseup",a),window.addEventListener("mousemove",o),window.addEventListener("resize",i),e.V360={},e.V360.destroy=function(){t.canvas.target.removeEventListener("mousedown",n),window.removeEventListener("mouseup",a),window.removeEventListener("mousemove",o),window.removeEventListener("resize",i),t.canvas.target.remove()},e.V360.start=function(){return r.init(e)},e.V360.restart=function(){e.V360.destroy(),e.V360.start()}},V360.prototype.onload=function(e){var t=this,r=e.canvas.target,n=e.canvas.ctx,a=e.imgs;return function(o){e.loadedImages++,e.loadedImages<e.frames&&!e.sprite||(t.resizeImage(r,a),t.setImage(r,n,a,e.currentImg,e.frames),t.onmousedown(e),t.onmouseup(e),t.onmousemove(e))}},V360.prototype.onmousedown=function(e){return function(t){e.mousePressing=!0,e.mouseStart=t.pageX}},V360.prototype.onmousemove=function(e){var t=this;return function(r){if(r.preventDefault(),e.mousePressing){var n=(e.mouseStart-r.pageX)/e.dragSensitivity;if(n>1&&(n=1),n<-1&&(n=-1),1==n||-1==n){e.mouseStart=r.pageX;var a=Math.round(n);e.currentImg+=a/Math.abs(a),e.currentImg>e.frames-1&&(e.currentImg=0),e.currentImg<0&&(e.currentImg=e.frames-1),t.setImage(e.canvas.target,e.canvas.ctx,e.imgs,e.currentImg,e.frames)}}}},V360.prototype.onmouseup=function(e){return function(){e.mousePressing=!1,e.mouseStart=0}},V360.prototype.onresize=function(e){var t=this;return function(){var r=e.target,n=e.canvas.target;if(n.width!=r.offsetWidth||n.height!=r.height){var a=e.canvas.ctx,o=e.imgs,i=e.currentImg;t.resizeCanvas(r,n),t.resizeImage(n,o),t.setImage(n,a,o,i,e.frames)}}};
//# sourceMappingURL=v360-min.js.map
