{"version":3,"sources":["Object/merge.js","v360.js","appendCanvas.js","preload.js","resizeCanvas.js","resizeImage.js","setImage.js","V360DOM.js","events/load.js","events/mousedown.js","events/mousemove.js","events/mouseup.js","events/resize.js"],"names":["Object","prototype","merge","object","key","V360","$v360","document","querySelectorAll","i","l","length","init","$target","props","target","srcs","undefined","sprite","frames","dragSensitivity","canvas","appendCanvas","imgs","currentImg","mousePressing","mouseStart","loadedImages","JSON","parse","getAttribute","replace","preload","onresize","V360DOM","window","addEventListener","createElement","resizeCanvas","ctx","getContext","appendChild","j","img","push","Image","onload","src","slice","$canvas","width","offsetWidth","height","offsetHeight","resizeImage","$img","setImage","n","clearRect","drawImage","mousedownHandle","onmousedown","mouseupHandle","onmouseup","mousemoveHandle","onmousemove","resizeHandle","destroy","removeEventListener","remove","start","restart","e","pageX","preventDefault","mouseMoved","roundMouseMoved","Math","round","abs"],"mappings":"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","file":"v360.js","sourcesContent":["Object.prototype.merge = function(object){\r\n    for (const key in object) this[key] = object[key];\r\n}","class V360{\r\n\r\n    constructor(){\r\n\r\n        const $v360 = document.querySelectorAll('[v360], [V360]');\r\n\r\n        for (let i = 0, l = $v360.length; i < l; i++)\r\n            this.init($v360[i]);\r\n\r\n    }\r\n\r\n    init($target){\r\n\r\n        const props = {\r\n\r\n            target: $target,\r\n            \r\n            srcs: undefined,\r\n            sprite: undefined,\r\n            frames: 0,\r\n            dragSensitivity: 5,\r\n\r\n            canvas: this.appendCanvas($target),\r\n\r\n            imgs: [],\r\n            currentImg: 0,\r\n\r\n            mousePressing: undefined,\r\n            mouseStart: 0,\r\n            \r\n            loadedImages: 0\r\n\r\n        };\r\n\r\n        props.merge(JSON.parse($target.getAttribute('v360').replace(/\\'/g, '\"')));\r\n\r\n        this.preload(props);\r\n        this.onresize(props);\r\n\r\n        this.V360DOM($target, props);\r\n\r\n    }\r\n\r\n}\r\n\r\nwindow.addEventListener('load', () => new V360());","V360.prototype.appendCanvas = function($target){\r\n\r\n    let canvas = {};\r\n\r\n    canvas.target = document.createElement('canvas');\r\n    this.resizeCanvas($target, canvas.target);\r\n\r\n    canvas.ctx = canvas.target.getContext('2d');\r\n\r\n    $target.appendChild(canvas.target);\r\n\r\n    return canvas;\r\n\r\n}","V360.prototype.preload = function(props){\r\n\r\n    // Preload all images\r\n    for(let j = 1; j <= props.frames; j++){\r\n\r\n        // Insert and get img from the array\r\n        const img = props.imgs[props.imgs.push(new Image()) - 1];\r\n\r\n        img.onload = this.onload(props);\r\n\r\n        if(props.sprite){\r\n            img.src = props.sprite;\r\n            break;\r\n        }\r\n\r\n        img.src = props.srcs.replace('#{frame}', ('000' + j).slice(-3));\r\n\r\n    }\r\n\r\n}","V360.prototype.resizeCanvas = function($target, $canvas){\r\n\r\n    $canvas.width = $target.offsetWidth;\r\n    $canvas.height = $target.offsetHeight;\r\n\r\n}","V360.prototype.resizeImage = function($canvas, imgs){\r\n\r\n    for(let i = 0, l = imgs.length; i < l; i++){\r\n\r\n        const $img = imgs[i];\r\n\r\n        // If l == 1 is a sprite\r\n        if($canvas.width <= $canvas.height && l > 1){\r\n\r\n            $img.height = ($img.height * $canvas.width) / $img.width;\r\n            $img.width = $canvas.width;\r\n\r\n        }else{\r\n\r\n            $img.width = ($img.width * $canvas.height) / $img.height;\r\n            $img.height = $canvas.height;\r\n\r\n        }\r\n\r\n    }\r\n\r\n}","V360.prototype.setImage = function($canvas, ctx, imgs, n, frames){\r\n\r\n    ctx.clearRect(0, 0, $canvas.width, $canvas.height);\r\n\r\n    // If length == 1 is a sprite\r\n    if(imgs.length > 1)\r\n        ctx.drawImage(imgs[n], 0, 0, imgs[n].width, imgs[n].height);\r\n    else{\r\n        ctx.drawImage(imgs[0],\r\n            -((imgs[0].width / frames) * n),\r\n            0,\r\n            imgs[0].width,\r\n            imgs[0].height\r\n        );\r\n    }\r\n\r\n}","V360.prototype.V360DOM = function($target, props){\r\n\r\n    const mousedownHandle = this.onmousedown(props);\r\n    const mouseupHandle = this.onmouseup(props);\r\n    const mousemoveHandle = this.onmousemove(props);\r\n    const resizeHandle = this.onresize(props);\r\n\r\n    props.canvas.target.addEventListener('mousedown', mousedownHandle);\r\n    window.addEventListener('mouseup', mouseupHandle);\r\n    window.addEventListener('mousemove', mousemoveHandle);\r\n    window.addEventListener('resize', resizeHandle);\r\n\r\n    $target.V360 = {};\r\n\r\n    $target.V360.destroy = () => {\r\n\r\n        props.canvas.target.removeEventListener('mousedown', mousedownHandle);\r\n        window.removeEventListener('mouseup', mouseupHandle);\r\n        window.removeEventListener('mousemove', mousemoveHandle);\r\n        window.removeEventListener('resize', resizeHandle);\r\n\r\n        props.canvas.target.remove();\r\n\r\n    }\r\n\r\n    $target.V360.start = () => this.init($target);\r\n\r\n    $target.V360.restart = () => {\r\n\r\n        $target.V360.destroy();\r\n        $target.V360.start();\r\n\r\n    }\r\n\r\n\r\n}","V360.prototype.onload = function(props){\r\n\r\n    const $canvas = props.canvas.target;\r\n    const ctx = props.canvas.ctx;\r\n    const imgs = props.imgs;\r\n\r\n    return e => {\r\n\r\n        props.loadedImages++;\r\n\r\n        if(props.loadedImages < props.frames && !props.sprite) return;\r\n\r\n        this.resizeImage($canvas, imgs);\r\n\r\n        this.setImage($canvas, ctx, imgs, props.currentImg, props.frames);\r\n\r\n        this.onmousedown(props);\r\n        this.onmouseup(props);\r\n        this.onmousemove(props);\r\n\r\n    }\r\n\r\n}","V360.prototype.onmousedown = function(props){\r\n\r\n    return e => {\r\n\r\n        props.mousePressing = true;\r\n        props.mouseStart = e.pageX;\r\n\r\n    }\r\n\r\n}","V360.prototype.onmousemove = function(props){\r\n\r\n    return e => {\r\n\r\n        e.preventDefault();\r\n\r\n        if(!props.mousePressing) return;\r\n\r\n        let mouseMoved = (props.mouseStart - e.pageX) / props.dragSensitivity;\r\n\r\n        if(mouseMoved > 1) mouseMoved = 1;\r\n        if(mouseMoved < -1) mouseMoved = -1;\r\n\r\n        if(mouseMoved == 1 || mouseMoved == -1){\r\n\r\n            props.mouseStart = e.pageX;\r\n\r\n            let roundMouseMoved = Math.round(mouseMoved);\r\n\r\n            props.currentImg += roundMouseMoved / Math.abs(roundMouseMoved);\r\n\r\n            if(props.currentImg > props.frames - 1) props.currentImg = 0;\r\n            if(props.currentImg < 0) props.currentImg = props.frames - 1;\r\n\r\n            this.setImage(props.canvas.target, props.canvas.ctx, props.imgs, props.currentImg, props.frames);\r\n\r\n        }\r\n\r\n    }\r\n\r\n}","V360.prototype.onmouseup = function(props){\r\n\r\n    return () => {\r\n\r\n        props.mousePressing = false;\r\n        props.mouseStart = 0;\r\n\r\n    }\r\n\r\n}","V360.prototype.onresize = function(props){\r\n\r\n    return () => {\r\n\r\n        const $target = props.target;\r\n        const $canvas = props.canvas.target;\r\n\r\n        if($canvas.width != $target.offsetWidth || $canvas.height != $target.height){\r\n\r\n            const ctx = props.canvas.ctx;\r\n            const imgs = props.imgs;\r\n            const currentImg = props.currentImg;\r\n\r\n            this.resizeCanvas($target, $canvas);\r\n            this.resizeImage($canvas, imgs);\r\n\r\n            this.setImage($canvas, ctx, imgs, currentImg, props.frames);\r\n            \r\n        }\r\n\r\n    }\r\n    \r\n}"]}