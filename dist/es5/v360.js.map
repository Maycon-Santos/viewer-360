{"version":3,"sources":["Object/merge.js","v360.js","appendCanvas.js","easingFunctions.js","preload.js","resizeCanvas.js","resizeImage.js","setImage.js","V360DOM.js","events/load.js","events/mousedown.js","events/mousemove.js","events/mouseup.js","events/resize.js","static/restart.js","static/set.js","static/start.js","static/stop.js"],"names":["Object","prototype","merge","object","key","V360","$v360","document","querySelectorAll","i","l","length","init","$target","v360","played","restart","props","target","srcs","undefined","sprite","frames","dragSensitivity","canvas","appendCanvas","imgs","currentFrame","allowDrag","mousePressing","mouseStart","loadedImages","allLoaded","JSON","parse","getAttribute","replace","preload","onresize","V360DOM","window","addEventListener","createElement","resizeCanvas","ctx","getContext","canvasStyle","webkitTouchCallout","webkitUserSelect","khtmlUserSelect","mozUserSelect","msUserSelect","userSelect","msTouchAction","touchAction","keys","map","style","appendChild","easingFunctions","linear","t","easeInQuad","easeOutQuad","easeInOutQuad","easeInCubic","easeOutCubic","easeInOutCubic","easeInQuart","easeOutQuart","easeInOutQuart","easeInQuint","easeOutQuint","easeInOutQuint","j","img","push","Image","onload","src","slice","$canvas","width","offsetWidth","height","offsetHeight","resizeImage","$img","realWidth","realHeight","setImage","n","clearRect","pos","spriteWidth","drawImage","mousedownHandle","onmousedown","mouseupHandle","onmouseup","mousemoveHandle","onmousemove","resizeHandle","start","stop","removeEventListener","remove","stopAnimation","animate","to","duration","easingFunction","callback","performance","now","progressed","requestAnimationFrame","time","timeFraction","progress","Infinity","Math","abs","direction","nextFrame","bind","e","pageX","touches","screenX","type","preventDefault","mouseMoved","roundMouseMoved","round","set","$element","setAttribute","stringify"],"mappings":"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","file":"v360.js","sourcesContent":["Object.prototype.merge = function(object){\r\n    for (const key in object) this[key] = object[key];\r\n}","class V360{\r\n\r\n    constructor(){\r\n\r\n        // Get all elements with attribute v360 or V360\r\n        const $v360 = document.querySelectorAll('[v360], [V360]');\r\n\r\n        // Transform this elements into Viewer 360\r\n        for (let i = 0, l = $v360.length; i < l; i++)\r\n            this.init($v360[i]);\r\n\r\n    }\r\n\r\n    init($target){\r\n\r\n        // If you receive start 2 times in a row\r\n        if($target.v360 && $target.v360.played)\r\n            return $target.v360.restart();\r\n\r\n        // It's like an instance. Saves properties for this element\r\n        const props = {\r\n\r\n            target: $target,\r\n\r\n            srcs: undefined,\r\n            sprite: undefined,\r\n            frames: 0,\r\n            dragSensitivity: 5,\r\n\r\n            canvas: this.appendCanvas($target),\r\n\r\n            imgs: [],\r\n            currentFrame: 0,\r\n\r\n            allowDrag: true,\r\n            mousePressing: undefined,\r\n            mouseStart: 0,\r\n\r\n            loadedImages: 0,\r\n            allLoaded: false\r\n\r\n        };\r\n\r\n        // Replace all ' to \"\r\n        props.merge(JSON.parse($target.getAttribute('v360').replace(/\\'/g, '\"')));\r\n\r\n        // Preload all images\r\n        this.preload(props);\r\n        this.onresize(props);\r\n\r\n        // Adds \"commands\" to the element (DOM)\r\n        this.V360DOM($target, props);\r\n\r\n    }\r\n\r\n}\r\n\r\n// On load the page instance the V360\r\nwindow.addEventListener('load', () => window.v360 = new V360());","V360.prototype.appendCanvas = function($target){\r\n\r\n    let canvas = {};\r\n\r\n    canvas.target = document.createElement('canvas');\r\n    this.resizeCanvas($target, canvas.target);\r\n\r\n    canvas.ctx = canvas.target.getContext('2d');\r\n\r\n    const canvasStyle = {\r\n        webkitTouchCallout: 'none',\r\n        webkitUserSelect: 'none',\r\n        khtmlUserSelect: 'none',\r\n        mozUserSelect: 'none',\r\n        msUserSelect: 'none',\r\n        userSelect: 'none',\r\n\r\n        msTouchAction: 'pan-y',\r\n        touchAction: 'pan-y'\r\n    };\r\n    \r\n    Object.keys(canvasStyle).map(style =>\r\n        canvas.target.style[style] = canvasStyle[style]);\r\n\r\n    $target.appendChild(canvas.target);\r\n\r\n    return canvas;\r\n\r\n}","/*  \r\n    * Github: https://gist.github.com/gre/1650294\r\n    * Easing Functions - inspired from http://gizma.com/easing/\r\n    * only considering the t value for the range [0, 1] => [0, 1]\r\n*/\r\nV360.prototype.easingFunctions = {\r\n    // no easing, no acceleration\r\n    linear: function (t) { return t },\r\n    // accelerating from zero velocity\r\n    easeInQuad: function (t) { return t*t },\r\n    // decelerating to zero velocity\r\n    easeOutQuad: function (t) { return t*(2-t) },\r\n    // acceleration until halfway, then deceleration\r\n    easeInOutQuad: function (t) { return t<.5 ? 2*t*t : -1+(4-2*t)*t },\r\n    // accelerating from zero velocity \r\n    easeInCubic: function (t) { return t*t*t },\r\n    // decelerating to zero velocity \r\n    easeOutCubic: function (t) { return (--t)*t*t+1 },\r\n    // acceleration until halfway, then deceleration \r\n    easeInOutCubic: function (t) { return t<.5 ? 4*t*t*t : (t-1)*(2*t-2)*(2*t-2)+1 },\r\n    // accelerating from zero velocity \r\n    easeInQuart: function (t) { return t*t*t*t },\r\n    // decelerating to zero velocity \r\n    easeOutQuart: function (t) { return 1-(--t)*t*t*t },\r\n    // acceleration until halfway, then deceleration\r\n    easeInOutQuart: function (t) { return t<.5 ? 8*t*t*t*t : 1-8*(--t)*t*t*t },\r\n    // accelerating from zero velocity\r\n    easeInQuint: function (t) { return t*t*t*t*t },\r\n    // decelerating to zero velocity\r\n    easeOutQuint: function (t) { return 1+(--t)*t*t*t*t },\r\n    // acceleration until halfway, then deceleration \r\n    easeInOutQuint: function (t) { return t<.5 ? 16*t*t*t*t*t : 1+16*(--t)*t*t*t*t }\r\n}","V360.prototype.preload = function(props){\r\n\r\n    // Preload all images\r\n    for(let j = 1; j <= props.frames; j++){\r\n\r\n        // Insert and get img from the array\r\n        const img = props.imgs[props.imgs.push(new Image()) - 1];\r\n\r\n        img.onload = this.onload(props);\r\n\r\n        // If is sprite\r\n        if(props.sprite){\r\n            img.src = props.sprite;\r\n            break;\r\n        }\r\n\r\n        img.src = props.srcs.replace('#{frame}', ('000' + j).slice(-3));\r\n\r\n    }\r\n\r\n}","// Place canvas in container size\r\nV360.prototype.resizeCanvas = function($target, $canvas){\r\n\r\n    $canvas.width = $target.offsetWidth;\r\n    $canvas.height = $target.offsetHeight;\r\n\r\n}","V360.prototype.resizeImage = function(props){\r\n\r\n    const $canvas = props.canvas.target;\r\n    const imgs = props.imgs;\r\n    const sprite = !!props.sprite; // Is a sprite\r\n    const frames = props.frames;\r\n\r\n    for(let i = 0, l = imgs.length; i < l; i++){\r\n\r\n        const $img = imgs[i];\r\n\r\n        if(sprite) $img.realWidth = $img.realWidth / frames;\r\n\r\n        // Simple rule of 3\r\n        $img.height = ($img.realHeight * $canvas.width) / $img.realWidth;\r\n        $img.width = $canvas.width;\r\n\r\n        if($img.width > $canvas.width || $img.height > $canvas.height){\r\n\r\n            // Simple rule of 3\r\n            $img.height = $canvas.height;\r\n            $img.width = ($img.realWidth * $canvas.height) / $img.realHeight;\r\n\r\n        }\r\n\r\n        if(sprite) {\r\n            $img.width = $img.width * frames;\r\n            $img.realWidth = $img.realWidth * frames;\r\n        }\r\n\r\n    }\r\n\r\n}","V360.prototype.setImage = function(props, n){\r\n\r\n    if(!props.allLoaded) return;\r\n\r\n    const $canvas = props.canvas.target;\r\n    const ctx = props.canvas.ctx;\r\n    const imgs = props.imgs;\r\n    const frames = props.frames;\r\n    const sprite = !!props.sprite;\r\n\r\n    const $img = imgs[sprite ? 0 : n];\r\n\r\n    ctx.clearRect(0, 0, $canvas.width, $canvas.height);\r\n\r\n    if(sprite){\r\n\r\n        const pos = -(($img.width / frames) * n);\r\n        const spriteWidth = $img.width / frames;\r\n\r\n        ctx.drawImage($img, pos, 0, $img.width, $img.height);\r\n\r\n        ctx.clearRect(spriteWidth, 0, $canvas.width - spriteWidth, $canvas.height);\r\n        \r\n    }else ctx.drawImage($img, 0, 0, $img.width, $img.height);\r\n\r\n}","V360.prototype.V360DOM = function($target, props){\r\n\r\n    const $canvas = props.canvas.target;\r\n    const frames = props.frames - 1;\r\n\r\n    // Handles\r\n    const mousedownHandle = this.onmousedown(props);\r\n    const mouseupHandle = this.onmouseup(props);\r\n    const mousemoveHandle = this.onmousemove(props);\r\n    const resizeHandle = this.onresize(props);\r\n\r\n    $canvas.addEventListener('mousedown', mousedownHandle);\r\n    window.addEventListener('mouseup', mouseupHandle);\r\n    window.addEventListener('mousemove', mousemoveHandle);\r\n    \r\n    $canvas.addEventListener('touchstart', mousedownHandle);\r\n    window.addEventListener('touchend', mouseupHandle);\r\n    window.addEventListener('touchmove', mousemoveHandle);\r\n\r\n    window.addEventListener('resize', resizeHandle);\r\n\r\n    $target.v360 = { played: true };\r\n\r\n    $target.v360.start = () => {\r\n\r\n        this.init($target);\r\n\r\n        $target.v360.played = true;\r\n\r\n    }\r\n\r\n    $target.v360.stop = () => {\r\n\r\n        // Remove events\r\n        $canvas.removeEventListener('mousedown', mousedownHandle);\r\n        window.removeEventListener('mouseup', mouseupHandle);\r\n        window.removeEventListener('mousemove', mousemoveHandle);\r\n\r\n        $canvas.removeEventListener('touchstart', mousedownHandle);\r\n        window.removeEventListener('touchend', mouseupHandle);\r\n        window.removeEventListener('touchmove', mousemoveHandle);\r\n\r\n        window.removeEventListener('resize', resizeHandle);\r\n\r\n        // Remove canvas of the DOM\r\n        if($canvas) $canvas.remove();\r\n\r\n        $target.v360.played = false;\r\n\r\n    }\r\n\r\n    $target.v360.restart = () => {\r\n\r\n        $target.v360.stop();\r\n        $target.v360.start();\r\n\r\n    }\r\n\r\n    let stopAnimation;\r\n    $target.v360.animate = (to, duration, easingFunction = 'linear', callback) => {\r\n\r\n        let start = performance.now();\r\n        let progressed = 0;\r\n\r\n        props.allowDrag = false;\r\n\r\n        requestAnimationFrame(function animate(time){\r\n\r\n            let timeFraction = (time - start) / duration;\r\n        \r\n            // Calculate the current animation state\r\n            let progress = this.easingFunctions[easingFunction || 'linear'](timeFraction);\r\n        \r\n            if(to == Infinity || to == -Infinity){\r\n\r\n                if(~~timeFraction > progressed){\r\n                    progressed = ~~timeFraction;\r\n                    props.currentFrame += (to == Infinity) ? 1 : -1;\r\n                }\r\n\r\n            }else if(~~(progress * Math.abs(to)) > progressed){\r\n\r\n                progressed = ~~(progress * Math.abs(to));\r\n\r\n                let direction = to / Math.abs(to);\r\n                let nextFrame = props.currentFrame + ~~(progress * to);\r\n                nextFrame = Math.abs(nextFrame / Math.abs(nextFrame));\r\n\r\n                if(direction < 0) nextFrame = -nextFrame;\r\n                \r\n                props.currentFrame += nextFrame;\r\n\r\n            }\r\n\r\n            if(props.currentFrame > frames) props.currentFrame = 0;\r\n            else if(props.currentFrame < 0) props.currentFrame = frames;\r\n\r\n            this.setImage(props, props.currentFrame);\r\n\r\n            if(stopAnimation) return props.allowDrag = !(stopAnimation = false);\r\n\r\n            if(to == Infinity || to == -Infinity) return requestAnimationFrame(animate.bind(this));\r\n\r\n            if(timeFraction < 1) return requestAnimationFrame(animate.bind(this));\r\n            else if(typeof callback == 'function')return callback();\r\n\r\n            // If you get here means the animation has come to an end\r\n            props.allowDrag = true;\r\n\r\n        }.bind(this));\r\n\r\n    }\r\n\r\n    $target.v360.stopAnimation = () => stopAnimation = true;\r\n\r\n    $target.v360.onload = null;\r\n\r\n}","V360.prototype.onload = function(props){\r\n\r\n    return e => {\r\n\r\n        props.loadedImages++;\r\n\r\n        e.target.realWidth = e.target.width;\r\n        e.target.realHeight = e.target.height;\r\n\r\n        // If did not load all images ends here\r\n        if(props.loadedImages < props.frames && !props.sprite) return;\r\n\r\n        props.allLoaded = props.allowDrag = true;\r\n\r\n        this.resizeImage(props);\r\n        this.setImage(props, props.currentFrame);\r\n\r\n        if(typeof props.target.v360.onload == 'function')\r\n            props.target.v360.onload();\r\n\r\n    }\r\n\r\n}","V360.prototype.onmousedown = function(props){\r\n\r\n    return e => {\r\n\r\n        // If drag dont's allowed stop here\r\n        if(!props.allowDrag) return;\r\n\r\n        // Serves to inform the other functions that the user began to drag\r\n        props.mousePressing = true;\r\n\r\n        // Saves the mouse or touch point\r\n        props.mouseStart = e.pageX || e.touches[0].screenX;\r\n\r\n    }\r\n\r\n}","V360.prototype.onmousemove = function(props){\r\n\r\n    return e => {\r\n\r\n        // If is mouse event set preventDefault()\r\n        if(e.type != 'touchmove') e.preventDefault();\r\n\r\n        // If you did not start the drag stop here\r\n        if(!props.mousePressing) return;\r\n\r\n        // Saves the mouse or touch point current\r\n        const pageX = e.pageX || e.touches[0].screenX;\r\n\r\n        let mouseMoved = (props.mouseStart - pageX) / props.dragSensitivity;\r\n\r\n        // Reverse the number pole\r\n        if(mouseMoved > 1) mouseMoved = 1;\r\n        if(mouseMoved < -1) mouseMoved = -1;\r\n\r\n        if(Math.abs(mouseMoved) == 1){\r\n\r\n            // Switches the starting point to the current\r\n            props.mouseStart = pageX;\r\n\r\n            let roundMouseMoved = Math.round(mouseMoved);\r\n\r\n            props.currentFrame += roundMouseMoved / Math.abs(roundMouseMoved);\r\n\r\n            // If the frame is greater than the maximum frame it returns to 0\r\n            if(props.currentFrame > props.frames - 1) props.currentFrame = 0;\r\n\r\n            // If the frame is below 0 it will be the maximum\r\n            if(props.currentFrame < 0) props.currentFrame = props.frames - 1;\r\n\r\n            // Draw image\r\n            this.setImage(props, props.currentFrame);\r\n\r\n        }\r\n\r\n    }\r\n\r\n}","V360.prototype.onmouseup = function(props){\r\n\r\n    return () => {\r\n\r\n        // Serves to inform the other functions that the user stopped dragging\r\n        props.mousePressing = false;\r\n        props.mouseStart = 0;\r\n\r\n    }\r\n\r\n}","V360.prototype.onresize = function(props){\r\n\r\n    return () => {\r\n\r\n        const $target = props.target;\r\n        const $canvas = props.canvas.target;\r\n\r\n        // If the container changes size\r\n        if($canvas.width != $target.offsetWidth || $canvas.height != $target.height){\r\n\r\n            const currentFrame = props.currentFrame;\r\n\r\n            this.resizeCanvas($target, $canvas);\r\n            this.resizeImage(props);\r\n\r\n            this.setImage(props, currentFrame);\r\n            \r\n        }\r\n\r\n    }\r\n    \r\n}","// Restart the viewer\r\nV360.prototype.restart = function(){\r\n\r\n    const $v360 = document.querySelectorAll('[v360], [V360]');\r\n\r\n    for (let i = 0, l = $v360.length; i < l; i++)\r\n        $v360[i].v360.restart();\r\n\r\n}","// Transform an element that is not a 360 viewer into a\r\nV360.prototype.set = function($element, props, callback){\r\n\r\n    $element.setAttribute('v360', JSON.stringify(props).replace(/\\\"/g, \"'\"));\r\n\r\n    this.init($element);\r\n\r\n    $element.v360.onload = callback;\r\n\r\n    return $element.v360;\r\n\r\n}","// Start viewer (Do not confuse with $DOM.v360.animation)\r\nV360.prototype.start = function(){\r\n\r\n    const $v360 = document.querySelectorAll('[v360], [V360]');\r\n\r\n    for (let i = 0, l = $v360.length; i < l; i++)\r\n        $v360[i].v360.start();\r\n\r\n}","// Stop the viewer (Do not confuse with $DOM.v360.stopAnimation)\r\nV360.prototype.stop = function(){\r\n\r\n    const $v360 = document.querySelectorAll('[v360], [V360]');\r\n\r\n    for (let i = 0, l = $v360.length; i < l; i++)\r\n        $v360[i].v360.stop();\r\n\r\n}"]}